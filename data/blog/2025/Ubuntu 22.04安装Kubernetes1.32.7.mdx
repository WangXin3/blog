---
title: Ubuntu 22.04å®‰è£…Kubernetes1.32.7
date: '2025-08-11'
tags: ['Ubantu', 'Kubernetes']
draft: false
summary: 'Ubuntu 22.04å®‰è£…Kubernetes1.32.7'
---

åœ¨ubuntuä¸­ä¸å»ºè®®ä½¿ç”¨rootç”¨æˆ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç»™æˆ‘ä»¬å½“å‰érootç”¨æˆ·æˆæƒ

# åŸºç¡€ç¯å¢ƒå‡†å¤‡ï¼ˆä¸‰å°æœºå™¨å‡éœ€æ‰§è¡Œï¼‰
1. å‡†å¤‡ä¸‰å°æœºå™¨å¹¶è®¾ç½®é™æ€ip
    | hostname | ip |
    | --- | --- |
    | k8smaster | 192.168.31.100 |
    | k8snode1 | 192.168.31.101 |
    | k8snode2 | 192.168.31.102 |

2. åˆ†åˆ«ä¸ºä¸‰å°è®¾å¤‡è®¾ç½®hostname	

    ```bash
    # masterèŠ‚ç‚¹æ‰§è¡Œ
    sudo hostnamectl set-hostname "k8smaster"

    # node1èŠ‚ç‚¹æ‰§è¡Œ
    sudo hostnamectl set-hostname "k8snode1"

    # node2èŠ‚ç‚¹æ‰§è¡Œ
    sudo hostnamectl set-hostname "k8snode2"
    ```

3. ä¸‰å°è®¾å¤‡å…¨éƒ¨æ‰§è¡Œï¼Œå†™å…¥åŸŸååˆ°hostæ–‡ä»¶

    ```bash
    sudo vim /etc/hosts

    # è¿½åŠ ä»¥ä¸‹å†…å®¹
    192.168.31.100 k8smaster
    192.168.31.101 k8snode1
    192.168.31.102 k8snode2
    ```

4. æ—¶é—´åŒæ­¥
    + è®¾ç½®æ—¶åŒºä¸ºä¸Šæµ·

    ```bash
    timedatectl set-timezone Asia/Shanghai
    ```

    + å®‰è£…ntpdateä¸é˜¿é‡Œäº‘åŒæ­¥æ—¶é—´

    ```bash
    sudo apt install -y ntpsec-ntpdate
    ntpdate ntp.aliyun.com
    ```

    + è®¾ç½®å®šæ—¶æ¯æ—¥åŒæ­¥

    ```bash
    crontab -e
    # é€‰æ‹©vim

    # ç„¶ååœ¨æœ€åè¿½åŠ å®šæ—¶ä»»åŠ¡
    0 0 * * * ntpdate ntp.aliyun.com
    ```

5. å¯ç”¨ IPv4 æ•°æ®åŒ…è½¬å‘

    ```bash
    # è®¾ç½®æ‰€éœ€çš„ sysctl å‚æ•°ï¼Œå‚æ•°åœ¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜
    cat <<EOF | sudo tee /etc/sysctl.d/k8s.conf
    net.ipv4.ip_forward = 1
    EOF

    cat << EOF | sudo tee /etc/modules-load.d/k8s.conf
    overlay
    br_netfilter
    EOF

    # åº”ç”¨ sysctl å‚æ•°è€Œä¸é‡æ–°å¯åŠ¨
    sudo sysctl --system

    # éªŒè¯æ˜¯å¦æˆåŠŸ
    sysctl net.ipv4.ip_forward
    ```

6. å®‰è£…ipvs

    ```bash
    sudo apt install -y ipset ipvsadm

    cat << EOF | sudo tee /etc/modules-load.d/ipvs.conf
    ip_vs
    ip_vs_rr
    ip_VS_wrr
    ip_vs_sh
    nf_conntrack
    EOF

    # åŠ è½½ipvsadmçš„æ¨¡å—
    sudo modprobe -- ip_vs
    sudo modprobe -- ip_vs_rr
    sudo modprobe -- ip_vs_wrr
    sudo modprobe -- ip_vs_sh
    sudo modprobe -- nf_conntrack

    # éªŒè¯æ˜¯å¦æˆåŠŸ
    lsmod | grep ip_vs
    # æœ‰ä»¥ä¸‹è¾“å‡ºå°±ç®—æˆåŠŸ
    ip_vs_sh               16384  0
    ip_vs_wrr              16384  0
    ip_vs_rr               16384  0
    ip_vs                 176128  6 ip_vs_rr,ip_vs_sh,ip_vs_wrr

    ```

7. å…³é—­swapåˆ†åŒº

    ```bash
    # æŸ¥çœ‹å½“å‰å¯ç”¨çš„äº¤æ¢åˆ†åŒº
    sudo swapon --show

    # ç¦ç”¨äº¤æ¢åˆ†åŒº
    sudo swapoff -a

    # ç¦æ­¢äº¤æ¢åˆ†åŒºåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½
    sudo vim /etc/fstab

    # æ³¨é‡Šæ‰å¦‚ä¸‹è¡Œ æ­¥éª¤ä¸€ä¸­æ˜¾ç¤ºçš„åˆ†åŒº
    /dev/sda2 none swap sw 0 0
    ```

# å®‰è£…å®¹å™¨è¿è¡Œæ—¶ï¼ˆä¸‰å°æœºå™¨å‡éœ€æ‰§è¡Œï¼‰
## å®‰è£…docker
åœ¨k8s1.24ï¼ˆåŒ…å«1.24ï¼‰ç‰ˆæœ¬åç§»é™¤äº†å†…ç½®çš„dockerå¼•æ“ï¼Œæ¨èä½¿ç”¨containerdå®¹å™¨è¿è¡Œæ—¶ã€‚
Kubernetes ç°åœ¨åªå¯¹æ¥å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆCRIï¼‰ï¼Œå…·ä½“å®ç°å®ƒå¹¶ä¸å…³æ³¨ï¼Œé‚£ä¹ˆç°åœ¨å®ç°äº†CRIå®¹å™¨è¿è¡Œæ—¶æ¥å£çš„å®ç°æœ‰containerdã€CRI-Oã€Docker Engineç­‰ã€‚
ä½†æ˜¯ä½¿ç”¨dockerä½œä¸ºè¿è¡Œæ—¶å®¹å™¨æ—¶éœ€è¦å®‰è£…cri-dockeræ’ä»¶ã€‚

```bash
# å®‰è£…å‰å…ˆå¸è½½æ“ä½œç³»ç»Ÿé»˜è®¤å®‰è£…çš„dockerï¼Œ
sudo apt-get remove docker docker-engine docker.io containerd runc

# é˜¿é‡Œæºï¼ˆæ¨èä½¿ç”¨é˜¿é‡Œçš„gpg KEYï¼‰
# å®‰è£…é˜¿é‡Œäº‘gpgè¯ä¹¦
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add 
 
# åœ¨æŒ‡å®šç›®å½•ä¸‹æ–°å»ºdocker.listæ–‡ä»¶ï¼Œæ·»åŠ é˜¿é‡Œäº‘é•œåƒæº
cd /etc/apt/sources.list.d
sudo touch docker.list && sudo chmod 666 docker.list
sudo echo "deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable" > docker.list

# æ›´æ–°è½¯ä»¶æº
sudo apt-get update && sudo apt-get upgrade

# å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Docker
sudo apt install docker-ce docker-ce-cli containerd.io
#ç­‰å¾…å®‰è£…å®Œæˆ

# å¯åŠ¨docker
sudo systemctl start docker

# æŸ¥çœ‹Dockerç‰ˆæœ¬
sudo docker version

# é…ç½®å¼€æœºè‡ªå¯åŠ¨
sudo systemctl enable docker

# æŸ¥çœ‹Dockerè¿è¡ŒçŠ¶æ€
sudo systemctl status docker

# å…è®¸éRootç”¨æˆ·æ‰§è¡Œdocker å‘½ä»¤
sudo usermod -aG docker $USER

# ä½¿æƒé™ç”Ÿæ•ˆ
newgrp docker 

# æµ‹è¯•æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker ps -a

# ç¼–è¾‘~/.bashrcæ–‡ä»¶ æ–°å¢ä¸‹é¢ä¸€è¡Œï¼Œè§£å†³é‡å¯åérootç”¨æˆ·æ‰§è¡Œdockerå‘½ä»¤å¤±æ•ˆé—®é¢˜
groupadd -f docker

# dockeråŠ é€Ÿ
sudo vim /etc/docker/daemon.json
# è¾“å…¥ä»¥ä¸‹åŠ é€Ÿé•œåƒåœ°å€å¹¶ä¿å­˜
{
    "registry-mirrors": [
        "https://docker.xuanyuan.me",
        "https://docker.m.daocloud.io",
        "https://docker.1ms.run"
    ]
}

# é‡å¯docker
sudo systemctl daemon-reload
sudo systemctl restart docker
```

## å®‰è£…cri-docker
åœ°å€ï¼š[https://github.com/Mirantis/cri-dockerd/releases](https://github.com/Mirantis/cri-dockerd/releases)

1. ä¸‹è½½v0.3.17ç‰ˆæœ¬ï¼ˆæœ¬æ–‡ä½¿ç”¨ï¼‰cri-dockerd-0.3.17.amd64.tgzï¼Œé…ç½®å¦‚ä¸‹ã€‚

    ```bash
    # è§£å‹
    tar xf cri-dockerd-0.3.17.amd64.tgz

    # è§£å‹å®Œæˆåï¼Œå…¶å®åªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼šcri-dockerd æŠŠå®ƒç§»åŠ¨åˆ° /usr/local/bin/ ä¸‹å³å¯
    sudo mv cri-dockerd/cri-dockerd /usr/local/bin/

    # éªŒè¯æ˜¯å¦æˆåŠŸ
    cri-dockerd --version
    ```

2. è®¾ç½®å¼€æœºå¯åŠ¨è„šæœ¬ï¼Œåˆ›å»ºæ–‡ä»¶ /etc/systemd/system/cri-dockerd.service ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ã€‚

    ```bash
    sudo vim /etc/systemd/system/cri-dockerd.service
    # è¾“å…¥ä»¥ä¸‹å†…å®¹
    [Unit]
    Description=CRI Interface for Docker Application Container Engine
    Documentation=https://docs.mirantis.com
    After=network-online.target firewalld.service docker.service
    Wants=network-online.target
    Requires=cri-dockerd.socket

    [Service]
    Type=notify
    ExecStart=/usr/local/bin/cri-dockerd --pod-infra-container-image=registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.10
     --network-plugin=cni --cni-conf-dir=/etc/cni/net.d --cni-bin-dir=/opt/cni/bin --container-runtime-endpoint=unix:///var/run/cri-dockerd.sock --cri-dockerd-root-directory=/var/lib/dockershim --docker-endpoint=unix:///var/run/docker.sock --cri-dockerd-root-directory=/var/lib/docker
    ExecReload=/bin/kill -s HUP $MAINPID
    TimeoutSec=0
    RestartSec=2
    Restart=always
    StartLimitBurst=3
    StartLimitInterval=60s
    LimitNOFILE=infinity
    LimitNPROC=infinity
    LimitCORE=infinity
    TasksMax=infinity
    Delegate=yes
    KillMode=process
    [Install]
    WantedBy=multi-user.target
    ```

3. åˆ›å»º /etc/systemd/system/cri-dockerd.socket æ–‡ä»¶ï¼Œå¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼Œæ³¨æ„æ”¹ä½ è‡ªå·±çš„ç”¨æˆ·åã€‚

    ```bash
    sudo vim /etc/systemd/system/cri-docker.socket

    [Unit]
    Description=CRI Docker Socket for the API
    PartOf=cri-dockerd.service

    [Socket]
    ListenStream=/var/run/cri-dockerd.sock
    SocketMode=0660
    SocketUser=wangxin
    SocketGroup=docker

    [Install]
    WantedBy=sockets.target
    ```

4. æ‰§è¡Œå¼€æœºè‡ªå¯åŠ¨å‘½ä»¤ã€‚

    ```bash
    systemctl daemon-reload
    systemctl enable cri-dockerd.service
    systemctl restart cri-dockerd.service
    ```

5. éªŒè¯æ˜¯å¦æˆåŠŸã€‚

    ```bash
    ls  /var/run | grep docker

    # æ˜¾ç¤ºä»¥ä¸‹å°±ç®—æˆåŠŸ
    cri-dockerd.sock
    docker
    docker.pid
    docker.sock
    ```

## é‡å¯åå†éªŒè¯
é‡å¯ä¸‰å°ç”µè„‘åå†éªŒè¯ä»¥ä¸Šéœ€è¦éªŒè¯å®‰è£…å®Œæˆçš„å‘½ä»¤ï¼Œä»¥ç¡®ä¿è½¯ä»¶/é…ç½®éƒ½å®‰è£…æˆ–æ­£ç¡®é…ç½®ï¼Œä¸èƒ½å¸¦ç€é—®é¢˜è¿›å…¥ä¸‹ä¸€æ­¥ã€‚

# å®‰è£…K8S
æœ¬æ–‡ä»¥k8s v1.32.7ä¸ºä¾‹

1. æ›´æ–°è½¯ä»¶ä»“åº“ï¼Œä¸‰å°è®¾å¤‡éƒ½æ‰§è¡Œã€‚

    ```bash
    sudo apt-get update

    # åŸºæœ¬å·¥å…· apt-transport-https å¯èƒ½æ˜¯ä¸€ä¸ªè™šæ‹ŸåŒ…ï¼ˆdummy packageï¼‰ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œä½ å¯ä»¥è·³è¿‡å®‰è£…è¿™ä¸ªåŒ…
    sudo apt-get install -y apt-transport-https ca-certificates curl gpg

    # å…¬å…±ç­¾åå¯†é’¥ï¼ˆ1.32ï¼‰
    # å¦‚æœ `/etc/apt/keyrings` ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åº”åœ¨ curl å‘½ä»¤ä¹‹å‰åˆ›å»ºå®ƒï¼Œè¯·é˜…è¯»ä¸‹é¢çš„æ³¨é‡Šã€‚
    # sudo mkdir -p -m 755 /etc/apt/keyrings
    curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.32/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg

    # éªŒè¯
    ls /etc/apt/keyrings/
    # ä¼šå‡ºä¸‹ä»¥ä¸‹æ˜¾ç¤º
    kubernetes-apt-keyring.gpg


    # å‡†å¤‡æºä»“åº“ æ­¤æ“ä½œä¼šè¦†ç›– /etc/apt/sources.list.d/kubernetes.list ä¸­ç°å­˜çš„æ‰€æœ‰é…ç½®ã€‚
    echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.32/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list

    # éªŒè¯
    ls /etc/apt/sources.list.d/
    # ä¼šå‡ºä¸‹ä»¥ä¸‹æ˜¾ç¤º
    docker.list  kubernetes.list

    # æ›´æ–°åŸä»“åº“ç´¢å¼•
    apt update
    ```

2. å®‰è£…kubeadm kubectl kubeletï¼Œä¸‰å°è®¾å¤‡éƒ½æ‰§è¡Œã€‚

    ```bash
    sudo apt-get install -y kubelet kubeadm kubectl
    ```

3. é…ç½®kubeletï¼Œä¸‰å°è®¾å¤‡éƒ½æ‰§è¡Œã€‚

    ```bash
    sudo vim /etc/default/kubelet

    # è¾“å…¥ä»¥ä¸‹é…ç½®cgroup
    KUBELET_EXTRA_ARGS="--cgroup-driver=systemd"

    # é…ç½®å¼€æœºè‡ªå¯åŠ¨
    systemctl enable kubelet
    ```

4. è§„åˆ’ipæ®µ

    | ç½‘æ®µåç§° | ç½‘æ®µ |
    | --- | --- |
    | å®¿ä¸»æœºç½‘æ®µ | 192.168.31.0/24 |
    | serviceç½‘æ®µ | 10.96.0.0/12 |
    | podç½‘æ®µ | 10.244.0.0/16 |

5. masteræ‰§è¡Œåˆå§‹åŒ–é›†ç¾¤å‘½ä»¤

    ```bash
    kubeadm init --kubernetes-version=1.32.7 --control-plane-endpoint=k8smaster --apiserver-advertise-address=192.168.31.100 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12  --image-repository=registry.aliyuncs.com/google_containers --cri-socket=unix:///var/run/cri-dockerd.sock  --upload-certs --v=9
    ```

    + kubernetes-versionï¼šæŒ‡å®šk8sçš„ç‰ˆæœ¬ï¼Œæˆ‘è¿™é‡Œæ˜¯1.32.7
    + control-plane-endpointï¼šå¯ä»¥ç†è§£ä¸ºé›†ç¾¤masterçš„å‘½å
    + apiserver-advertise-addressï¼šé›†ç¾¤ä¸­masterçš„åœ°å€ï¼æ³¨æ„ä¸è¦æŠ„ï¼Œå†™ä½ è‡ªå·±è™šæ‹Ÿæœºçš„ipåœ°å€
    + pod-network-cidrï¼špodç½‘æ®µåœ°å€ï¼Œåªè¦ä¸ä¸é›†ç¾¤ç½‘æ®µå’Œserviceç½‘æ®µé‡å¤å³å¯
    + service-cidrï¼šserviceç½‘æ®µåœ°å€ï¼Œåªè¦ä¸ä¸é›†ç¾¤ç½‘æ®µå’Œpodç½‘æ®µé‡å¤å³å¯
    + image-repositoryï¼šæŒ‡å®šä½¿ç”¨å›½å†…é•œåƒ
    + cri-socketï¼šæŒ‡å®šä½¿ç”¨çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå¦‚æœä½ ä½¿ç”¨çš„containerdå®¹å™¨ï¼Œé‚£å°±ä¸ç”¨å†™è¿™ä¸ªå‚æ•°
    + vï¼šæ—¥å¿—çº§åˆ«ï¼Œ9è¡¨ç¤ºè¾“å‡ºçš„ä¿¡æ¯ä¼šå¾ˆè¯¦ç»†

6. ç­‰å¾…å®‰è£…æˆåŠŸ

    ![](/static/images/Ubuntu2204å®‰è£…Kubernetes1_32_7/img.png)

7. å®‰è£…å®Œæˆä¹‹åä¼šå‡ºç°ä»¥ä¸‹æŒ‡ä»¤1

    ```bash
    mkdir -p $HOME/.kube
    sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
    sudo chown $(id -u):$(id -g) $HOME/.kube/config
    ```

    åœ¨masterèŠ‚ç‚¹æ‰§è¡Œä»¥ä¸Šæ‰§è¡Œ

8. æŒ‡ä»¤2ï¼Œç±»ä¼¼å³å¯ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„åŒºåˆ†ï¼Œæœ‰ä¸€ä¸ªæ˜¯ä½œä¸ºæ§åˆ¶é¢æ¿åŠ å…¥çš„ï¼Œä¸¤ä¸ªå‘½ä»¤å¾ˆç›¸ä¼¼ï¼Œé‚£ä¸ªå‘½ä»¤å¤šäº†ä¸€ä¸ª`--control-plane`ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦nodeä½œä¸ºå·¥ä½œèŠ‚ç‚¹ã€‚ç„¶åè¿˜éœ€è¦åœ¨è¯¥æŒ‡ä»¤åé¢å¢åŠ `--cri-socket=unix:///var/run/cri-dockerd.sock `

    ```bash
    sudo kubeadm join k8smaster:6443 --token wua7k6.56sc0gpyjiqcf515 \
      --discovery-token-ca-cert-hash sha256:50a1cce6ceba3bf7b384f2db8f532e75bf0423bf9192506f4e7df9260c6da9d1
    ```

    ä¿®æ”¹åçš„æŒ‡ä»¤å¦‚ä¸‹ï¼Œç„¶ååˆ†åˆ«åœ¨ä¸¤ä¸ªnodeèŠ‚ç‚¹æ‰§è¡Œã€‚æ³¨æ„è¿™é‡Œè¦ç”¨ä½ è‡ªå·±ç”Ÿæˆå¥½çš„æŒ‡ä»¤ã€‚

    ```bash
    sudo kubeadm join k8smaster:6443 --token wua7k6.56sc0gpyjiqcf515 \
      --discovery-token-ca-cert-hash sha256:50a1cce6ceba3bf7b384f2db8f532e75bf0423bf9192506f4e7df9260c6da9d1 \
      --cri-socket=unix:///var/run/cri-dockerd.sock
    ```

9. ç­‰å¾…ä¸¤ä¸ªèŠ‚ç‚¹åŠ å…¥å®Œæˆä¹‹åï¼Œåœ¨masterèŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯nodeæ˜¯å¦åŠ å…¥æˆåŠŸã€‚

    ```bash
    kubectl get nodes

    NAME        STATUS       ROLES           AGE    VERSION
    k8smaster   NotReady     control-plane   5h3m   v1.32.7
    k8snode1    NotReady     <none>          5h1m   v1.32.7
    k8snode2    NotReady     <none>          5h1m   v1.32.7
    ```

10. æ­¤æ—¶èŠ‚ç‚¹è™½ç„¶å·²ç»åŠ å…¥ï¼Œä½†æ˜¯æ˜¯NotReadyçŠ¶æ€ï¼Œè¿˜éœ€è¦å®‰è£…ç½‘ç»œç»„ä»¶calicoã€‚masteræ‰§è¡Œã€‚

    å®‰è£…æ•™ç¨‹ï¼š[https://docs.tigera.io/calico/latest/getting-started/kubernetes/k8s-single-node#install-calico](https://docs.tigera.io/calico/latest/getting-started/kubernetes/k8s-single-node#install-calico)

    ```bash
    # ç¬¬ä¸€æ­¥ä¸‹è½½éƒ¨ç½²yamlæ–‡ä»¶
    kubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.30.2/manifests/tigera-operator.yaml

    # ç¬¬äºŒæ­¥ä¸èƒ½ç›´æ¥å®‰è£…å®˜ç½‘å®‰è£…æˆ‘ä»¬éœ€è¦å…ˆä¸‹è½½ï¼Œä¿®æ”¹cidrç½‘æ®µåœ°å€å†åˆ›å»º
    wget https://raw.githubusercontent.com/projectcalico/calico/v3.30.2/manifests/custom-resources.yaml
    ```

    ä¿®æ”¹custom-resources.yaml

    ```yaml
    # This section includes base Calico installation configuration.
    # For more information, see: https://docs.tigera.io/calico/latest/reference/installation/api#operator.tigera.io/v1.Installation
    apiVersion: operator.tigera.io/v1
    kind: Installation
    metadata:
      name: default
    spec:
      # Configures Calico networking.
      calicoNetwork:
        ipPools:
        - name: default-ipv4-ippool
          blockSize: 26
          cidr: 10.244.0.0/16
          encapsulation: VXLANCrossSubnet
          natOutgoing: Enabled
          nodeSelector: all()

    ---

    # This section configures the Calico API server.
    # For more information, see: https://docs.tigera.io/calico/latest/reference/installation/api#operator.tigera.io/v1.APIServer
    apiVersion: operator.tigera.io/v1
    kind: APIServer
    metadata:
      name: default
    spec: {}

    ---

    # Configures the Calico Goldmane flow aggregator.
    #apiVersion: operator.tigera.io/v1
    #kind: Goldmane
    #metadata:
    #  name: default

    ---

    # Configures the Calico Whisker observability UI.
    #apiVersion: operator.tigera.io/v1
    #kind: Whisker
    #metadata:
    #  name: default
    ```

    ```bash
    # ä¿®æ”¹cidrçš„ç½‘æ®µåœ°å€ä¸ºä¸Šé¢è§„åˆ’çš„opdç½‘æ®µ
    cidr: 10.244.0.0/16

    # åé¢ä¸¤ä¸ªç›®å‰ä¸éœ€è¦æ³¨é‡Šæ‰å³å¯

    # ç„¶åå®‰è£…
    kubectl create -f custom-resources.yaml
    ```

11. æŸ¥çœ‹calicoå®‰è£…è¿›åº¦ï¼Œè¿™é‡Œåæœ‰å…«ä¹ä¼šå¤±è´¥ï¼Œå…·ä½“åŸå› å°±æ˜¯é•œåƒæ‹‰å–ä¸ä¸‹æ¥ï¼Œä½†æ˜¯åªèƒ½é è‡ªå·±æƒ³å…¶ä»–åŠæ³•
    + é•œåƒåŠ é€Ÿ
    + ç§‘å­¦ä¸Šç½‘
    + ...

    ```bash
    # æ£€æŸ¥calicoå¯åŠ¨è¿›åº¦
    kubectl get pod -n calico-system

    NAME                                       READY   STATUS    RESTARTS       AGE
    calico-kube-controllers-59ddcd865c-g9czc   1/1     Running   3 (138m ago)   5h3m
    calico-node-5njtx                          1/1     Running   3 (138m ago)   5h3m
    calico-node-dr4fk                          1/1     Running   3 (138m ago)   5h3m
    calico-node-zwrmq                          1/1     Running   3 (138m ago)   5h3m
    calico-typha-6d8d7d8888-s6hxv              1/1     Running   3 (138m ago)   5h3m
    calico-typha-6d8d7d8888-xtrnq              1/1     Running   3 (138m ago)   5h3m
    csi-node-driver-ck4sj                      2/2     Running   6 (138m ago)   5h3m
    csi-node-driver-wwmps                      2/2     Running   4 (138m ago)   5h3m
    csi-node-driver-ztgxj                      2/2     Running   6 (138m ago)   5h3m
    goldmane-5f56496f4c-dtr8x                  1/1     Running   3 (138m ago)   5h3m
    whisker-6c6d5848fc-7n6dl                   2/2     Running   6 (138m ago)   5h2m

    kubectl get pod -n calico-apiserver
    NAME                                READY   STATUS    RESTARTS      AGE
    calico-apiserver-5d6c5fd597-4pkpc   1/1     Running   4 (82m ago)   5h5m
    calico-apiserver-5d6c5fd597-cplc7   1/1     Running   5 (83m ago)   5h5m
    ```

    ç­‰å¾…å…¨éƒ¨Runningä¹‹åï¼Œé‚£ä¹ˆcalicoå®‰è£…æˆåŠŸï¼Œæ­¤æ—¶å†æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹nodeåŠ å…¥æƒ…å†µ

    ```bash
    kubectl get nodes

    NAME        STATUS   ROLES           AGE     VERSION
    k8smaster   Ready    control-plane   5h12m   v1.32.7
    k8snode1    Ready    <none>          5h10m   v1.32.7
    k8snode2    Ready    <none>          5h9m    v1.32.7
    ```

    è‡³æ­¤ï¼Œk8sé›†ç¾¤å®‰è£…æˆåŠŸï¼ï¼ï¼ä½ çœŸçš„å¾ˆæ£’ğŸ‘

